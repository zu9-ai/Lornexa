<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ü¶ã Lornexa - Neurodiversity Companion</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --main-color: #cc6872;
            --bg-primary: #fff5f7;
            --text-primary: #5a3d3d;
            --success-color: #88cc72;
            --warning-color: #ffb366;
        }

        body {
            font-family: 'Arial', sans-serif;
            background-color: var(--bg-primary);
            color: var(--text-primary);
        }

        .screen {
            display: none;
            padding: 20px;
            min-height: 100vh;
        }

        .active {
            display: block;
        }

        /* Welcome Screen */
        .welcome-screen {
            text-align: center;
            padding-top: 50px;
        }

        .butterfly-logo {
            font-size: 4rem;
            margin-bottom: 20px;
        }

        .welcome-title {
            font-size: 2.5rem;
            color: var(--main-color);
            margin-bottom: 10px;
        }

        .welcome-subtitle {
            font-size: 1.2rem;
            margin-bottom: 40px;
            color: #8c6b6b;
        }

        .btn {
            background-color: var(--main-color);
            color: white;
            border: none;
            padding: 15px 30px;
            font-size: 1.2rem;
            border-radius: 25px;
            cursor: pointer;
            margin: 10px;
        }

        .btn:hover {
            opacity: 0.9;
        }

        /* Assessment Screen */
        .question-container {
            background: white;
            padding: 20px;
            border-radius: 15px;
            margin: 20px 0;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }

        .progress-bar {
            width: 100%;
            height: 10px;
            background: #e0e0e0;
            border-radius: 5px;
            margin: 20px 0;
        }

        .progress-fill {
            height: 100%;
            background: var(--main-color);
            border-radius: 5px;
            transition: width 0.3s;
        }

        .scale-slider {
            width: 100%;
            margin: 20px 0;
        }

        .binary-options {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin: 20px 0;
        }

        .radio-option {
            padding: 10px 20px;
            border: 2px solid var(--main-color);
            border-radius: 20px;
            cursor: pointer;
        }

        .radio-option.selected {
            background: var(--main-color);
            color: white;
        }

        .typing-input {
            width: 100%;
            padding: 15px;
            border: 2px solid var(--main-color);
            border-radius: 10px;
            font-size: 1.1rem;
            margin: 20px 0;
        }

        /* Results Screen */
        .results-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin: 20px 0;
        }

        .score-card {
            background: white;
            padding: 15px;
            border-radius: 10px;
            text-align: center;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }

        .score-high {
            color: var(--warning-color);
        }

        .score-medium {
            color: var(--main-color);
        }

        .score-low {
            color: var(--success-color);
        }

        /* Characters Screen */
        .character-card {
            background: white;
            margin: 15px 0;
            padding: 20px;
            border-radius: 15px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }

        .character-header {
            display: flex;
            align-items: center;
            gap: 15px;
            margin-bottom: 15px;
        }

        .character-avatar {
            width: 60px;
            height: 60px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
        }

        .character-drawing {
            font-size: 2rem;
            text-align: center;
            margin: 10px 0;
        }

        /* Chat Screen */
        .chat-container {
            display: grid;
            grid-template-columns: 1fr 2fr;
            gap: 20px;
            height: 80vh;
        }

        .character-info {
            background: white;
            padding: 20px;
            border-radius: 15px;
            text-align: center;
        }

        .chat-area {
            background: white;
            border-radius: 15px;
            padding: 20px;
            display: flex;
            flex-direction: column;
        }

        .messages {
            flex: 1;
            overflow-y: auto;
            margin-bottom: 20px;
        }

        .message {
            margin: 10px 0;
            padding: 10px 15px;
            border-radius: 15px;
            max-width: 80%;
        }

        .user-message {
            background: var(--main-color);
            color: white;
            margin-left: auto;
        }

        .bot-message {
            background: #f0f0f0;
            color: var(--text-primary);
        }

        .chat-input-container {
            display: flex;
            gap: 10px;
        }

        .chat-input {
            flex: 1;
            padding: 15px;
            border: 2px solid var(--main-color);
            border-radius: 25px;
        }

        .nav-buttons {
            display: flex;
            justify-content: space-between;
            margin-top: 20px;
        }
    </style>
</head>
<body>
    <!-- Welcome Screen -->
    <div id="welcomeScreen" class="screen active">
        <div class="welcome-screen">
            <div class="butterfly-logo">ü¶ã</div>
            <h1 class="welcome-title">Lornexa</h1>
            <p class="welcome-subtitle">Fun Assessment & Friendly AI Companions</p>
            <button class="btn" onclick="showScreen('demographicsScreen')">
                Start Fun Assessment ü¶ã
            </button>
        </div>
    </div>

    <!-- Demographics Screen -->
    <div id="demographicsScreen" class="screen">
        <h2>üë§ Tell Us About You</h2>
        <div class="question-container">
            <label>Age:</label>
            <input type="number" id="ageInput" min="12" max="18" value="15" class="typing-input">
            
            <label>Gender:</label>
            <select id="genderSelect" class="typing-input">
                <option>Male</option>
                <option>Female</option>
                <option>Non-binary</option>
                <option>Prefer not to say</option>
            </select>
            
            <button class="btn" onclick="startAssessment()">Start Questions ü¶ã</button>
        </div>
    </div>

    <!-- Assessment Screen -->
    <div id="assessmentScreen" class="screen">
        <h3 id="questionNumber">Question 1 of 15 ü¶ã</h3>
        <div class="progress-bar">
            <div id="progressFill" class="progress-fill" style="width: 0%"></div>
        </div>
        
        <div class="question-container">
            <h4 id="questionText"></h4>
            
            <!-- Scale Question -->
            <div id="scaleSection" style="display: none;">
                <input type="range" id="scaleSlider" class="scale-slider" min="1" max="10" value="5">
                <div style="text-align: center;">
                    <span id="scaleValue">5</span>/10
                </div>
            </div>
            
            <!-- Binary Question -->
            <div id="binarySection" style="display: none;">
                <div class="binary-options">
                    <div class="radio-option" onclick="selectBinaryOption('Yes')">Yes</div>
                    <div class="radio-option" onclick="selectBinaryOption('No')">No</div>
                </div>
            </div>
            
            <!-- Typing Question -->
            <div id="typingSection" style="display: none;">
                <input type="text" id="typingInput" class="typing-input" placeholder="Type your answer...">
                <div id="typingHint" style="color: #8c6b6b; font-style: italic;"></div>
            </div>
        </div>
        
        <div class="nav-buttons">
            <button class="btn" onclick="previousQuestion()" id="prevBtn" style="display: none;">‚Üê Previous</button>
            <button class="btn" onclick="nextQuestion()" id="nextBtn">Next ‚Üí</button>
        </div>
    </div>

    <!-- Results Screen -->
    <div id="resultsScreen" class="screen">
        <h2>üìä Your Assessment Results</h2>
        
        <div class="results-grid">
            <div class="score-card">
                <h4>Social Communication</h4>
                <div id="socialScore" class="score-medium">0/10</div>
            </div>
            <div class="score-card">
                <h4>Sensory Processing</h4>
                <div id="sensoryScore" class="score-medium">0/10</div>
            </div>
            <div class="score-card">
                <h4>Special Interests</h4>
                <div id="interestsScore" class="score-medium">0/10</div>
            </div>
            <div class="score-card">
                <h4>Routine Preference</h4>
                <div id="routineScore" class="score-medium">0/10</div>
            </div>
            <div class="score-card">
                <h4>Emotional Expression</h4>
                <div id="emotionalScore" class="score-medium">0/10</div>
            </div>
        </div>
        
        <canvas id="radarChart" width="400" height="400"></canvas>
        
        <div class="nav-buttons">
            <button class="btn" onclick="restartAssessment()">üîÑ Take Again</button>
            <button class="btn" onclick="showScreen('charactersScreen')">üé≠ Meet AI Friends</button>
        </div>
    </div>

    <!-- Characters Screen -->
    <div id="charactersScreen" class="screen">
        <h2>üé≠ Choose Your AI Friend</h2>
        <div id="recommendationBanner" class="character-card" style="background: #ffeb3b; text-align: center;">
            <strong>üåü RECOMMENDED FOR YOU</strong>
        </div>
        
        <div id="charactersList">
            <!-- Character cards will be added here by JavaScript -->
        </div>
        
        <div class="nav-buttons">
            <button class="btn" onclick="showScreen('resultsScreen')">‚Üê Back to Results</button>
        </div>
    </div>

    <!-- Chat Screen -->
    <div id="chatScreen" class="screen">
        <h2 id="chatHeader">üí¨ Chat</h2>
        
        <div class="chat-container">
            <div class="character-info">
                <div id="chatAvatar" class="character-avatar" style="background: var(--main-color);">üë§</div>
                <h3 id="chatCharacterName">Character</h3>
                <p id="chatCharacterDesc">Description</p>
                <div id="chatCharacterDrawing" class="character-drawing">üé®</div>
            </div>
            
            <div class="chat-area">
                <div id="messages" class="messages">
                    <!-- Messages will be added here -->
                </div>
                
                <div class="chat-input-container">
                    <input type="text" id="chatInput" class="chat-input" placeholder="Type your message...">
                    <button class="btn" onclick="sendMessage()">Send ü¶ã</button>
                </div>
            </div>
        </div>
        
        <div class="nav-buttons">
            <button class="btn" onclick="showScreen('charactersScreen')">‚Üê Back to Characters</button>
        </div>
    </div>

    <script>
        // App Data
        const questions = [
            {question: "How comfortable are you in group conversations? (1-10)", type: "scale", category: "Social"},
            {question: "Do loud noises bother you more than others? (1-10)", type: "scale", category: "Sensory"},
            {question: "How deep are your interests in favorite topics? (1-10)", type: "scale", category: "Interests"},
            {question: "How important is routine in your daily life? (1-10)", type: "scale", category: "Routine"},
            {question: "How easy is it to describe your feelings? (1-10)", type: "scale", category: "Emotional"},
            {question: "Do you prefer one-on-one conversations?", type: "binary", category: "Social"},
            {question: "Are textures important in food/clothes?", type: "binary", category: "Sensory"},
            {question: "Do you research topics intensely?", type: "binary", category: "Interests"},
            {question: "Does schedule change cause stress?", type: "binary", category: "Routine"},
            {question: "Do others understand your emotions easily?", type: "binary", category: "Emotional"},
            {question: "What's your favorite way to relax? (1-2 words)", type: "typing", category: "Sensory", maxWords: 2},
            {question: "Describe your perfect day in 2-3 words", type: "typing", category: "Routine", maxWords: 3},
            {question: "What makes you really happy? (1 word)", type: "typing", category: "Emotional", maxWords: 1},
            {question: "Your favorite topic to learn about? (1-2 words)", type: "typing", category: "Interests", maxWords: 2},
            {question: "Favorite social activity? (1 word)", type: "typing", category: "Social", maxWords: 1}
        ];

        const characters = [
            {
                name: "Alex Explorer",
                color: "#cc6872",
                emoji: "üåç",
                description: "Adventure guide who loves discovering new things",
                specialty: "Creative thinking & problem solving",
                drawing: "ü¶ãüó∫Ô∏èüåü"
            },
            {
                name: "Dr. Luna",
                color: "#72aacc", 
                emoji: "üî≠",
                description: "Science expert who explains things clearly",
                specialty: "Patterns & logical thinking",
                drawing: "‚≠êüîçüìä"
            },
            {
                name: "Cosmo Artist",
                color: "#ffaa66",
                emoji: "üé®",
                description: "Creative friend who sees the world in colors",
                specialty: "Emotional expression & creativity", 
                drawing: "üé®üåà‚ú®"
            },
            {
                name: "Professor Quantum",
                color: "#72cc88",
                emoji: "‚öõÔ∏è",
                description: "Math wizard who loves puzzles and patterns",
                specialty: "Logical analysis & systems",
                drawing: "üß©üî¢‚ö°"
            },
            {
                name: "Storyteller Sam",
                color: "#aa72cc",
                emoji: "üìö", 
                description: "Friendly storyteller who creates amazing adventures",
                specialty: "Communication & social stories",
                drawing: "üìñüë´üé≠"
            },
            {
                name: "Nature Nova",
                color: "#88cc72",
                emoji: "üåø",
                description: "Nature explorer who finds calm in the outdoors",
                specialty: "Sensory awareness & mindfulness",
                drawing: "üå≥ü¶ã‚òÄÔ∏è"
            }
        ];

        // App State
        let currentQuestion = 0;
        let responses = new Array(15).fill('');
        let scores = {
            Social: 0, Sensory: 0, Interests: 0, Routine: 0, Emotional: 0
        };
        let selectedCharacter = null;

        // Screen Navigation
        function showScreen(screenId) {
            document.querySelectorAll('.screen').forEach(screen => {
                screen.classList.remove('active');
            });
            document.getElementById(screenId).classList.add('active');
            
            if (screenId === 'assessmentScreen') {
                displayQuestion();
            } else if (screenId === 'resultsScreen') {
                calculateScores();
                displayResults();
            } else if (screenId === 'charactersScreen') {
                displayCharacters();
            }
        }

        // Assessment Functions
        function displayQuestion() {
            const question = questions[currentQuestion];
            document.getElementById('questionNumber').textContent = `Question ${currentQuestion + 1} of 15 ü¶ã`;
            document.getElementById('questionText').textContent = question.question;
            document.getElementById('progressFill').style.width = `${((currentQuestion + 1) / 15) * 100}%`;
            
            // Hide all sections first
            document.getElementById('scaleSection').style.display = 'none';
            document.getElementById('binarySection').style.display = 'none';
            document.getElementById('typingSection').style.display = 'none';
            
            // Show appropriate section
            if (question.type === 'scale') {
                document.getElementById('scaleSection').style.display = 'block';
                document.getElementById('scaleSlider').value = responses[currentQuestion] || 5;
                updateScaleValue();
            } else if (question.type === 'binary') {
                document.getElementById('binarySection').style.display = 'block';
                document.querySelectorAll('.radio-option').forEach(opt => {
                    opt.classList.remove('selected');
                    if (opt.textContent === responses[currentQuestion]) {
                        opt.classList.add('selected');
                    }
                });
            } else if (question.type === 'typing') {
                document.getElementById('typingSection').style.display = 'block';
                document.getElementById('typingInput').value = responses[currentQuestion] || '';
                document.getElementById('typingHint').textContent = `üí° Tip: Try to answer in ${question.maxWords} word(s) or less`;
            }
            
            // Navigation buttons
            document.getElementById('prevBtn').style.display = currentQuestion === 0 ? 'none' : 'block';
            document.getElementById('nextBtn').textContent = currentQuestion === 14 ? 'See My Results ü¶ã' : 'Next ‚Üí';
        }

        function updateScaleValue() {
            document.getElementById('scaleValue').textContent = document.getElementById('scaleSlider').value;
        }

        function selectBinaryOption(option) {
            document.querySelectorAll('.radio-option').forEach(opt => {
                opt.classList.remove('selected');
            });
            event.target.classList.add('selected');
            responses[currentQuestion] = option;
        }

        function nextQuestion() {
            // Save current response
            const question = questions[currentQuestion];
            if (question.type === 'scale') {
                responses[currentQuestion] = document.getElementById('scaleSlider').value;
            } else if (question.type === 'typing') {
                responses[currentQuestion] = document.getElementById('typingInput').value;
            }
            
            if (currentQuestion < 14) {
                currentQuestion++;
                displayQuestion();
            } else {
                showScreen('resultsScreen');
            }
        }

        function previousQuestion() {
            if (currentQuestion > 0) {
                currentQuestion--;
                displayQuestion();
            }
        }

        function startAssessment() {
            currentQuestion = 0;
            responses = new Array(15).fill('');
            showScreen('assessmentScreen');
        }

        function restartAssessment() {
            currentQuestion = 0;
            responses = new Array(15).fill('');
            showScreen('assessmentScreen');
        }

        // Results Functions
        function calculateScores() {
            // Reset scores
            scores = {Social: 0, Sensory: 0, Interests: 0, Routine: 0, Emotional: 0};
            const counts = {Social: 0, Sensory: 0, Interests: 0, Routine: 0, Emotional: 0};
            
            questions.forEach((question, index) => {
                const response = responses[index];
                if (response) {
                    if (question.type === 'scale') {
                        scores[question.category] += parseInt(response);
                        counts[question.category]++;
                    } else if (question.type === 'binary') {
                        scores[question.category] += response === 'Yes' ? 8 : 2;
                        counts[question.category]++;
                    } else if (question.type === 'typing') {
                        const wordCount = response.trim().split(/\s+/).length;
                        scores[question.category] += Math.min(wordCount * 2, 8);
                        counts[question.category]++;
                    }
                }
            });
            
            // Calculate averages
            Object.keys(scores).forEach(category => {
                if (counts[category] > 0) {
                    scores[category] = Math.round((scores[category] / counts[category]) * 10) / 10;
                }
            });
        }

        function displayResults() {
            // Update score displays
            document.getElementById('socialScore').textContent = `${scores.Social}/10`;
            document.getElementById('sensoryScore').textContent = `${scores.Sensory}/10`;
            document.getElementById('interestsScore').textContent = `${scores.Interests}/10`;
            document.getElementById('routineScore').textContent = `${scores.Routine}/10`;
            document.getElementById('emotionalScore').textContent = `${scores.Emotional}/10`;
            
            // Color code scores
            colorCodeScore('socialScore', scores.Social);
            colorCodeScore('sensoryScore', scores.Sensory);
            colorCodeScore('interestsScore', scores.Interests);
            colorCodeScore('routineScore', scores.Routine);
            colorCodeScore('emotionalScore', scores.Emotional);
            
            // Generate radar chart
            generateRadarChart();
        }

        function colorCodeScore(elementId, score) {
            const element = document.getElementById(elementId);
            element.className = 'score-' + (score >= 7 ? 'high' : score >= 4 ? 'medium' : 'low');
        }

        function generateRadarChart() {
            const ctx = document.getElementById('radarChart').getContext('2d');
            
            // Simple chart implementation
            ctx.clearRect(0, 0, 400, 400);
            
            // Draw simple radar chart
            const centerX = 200, centerY = 200, radius = 150;
            const categories = ['Social', 'Sensory', 'Interests', 'Routine', 'Emotional'];
            const angles = [0, 72, 144, 216, 288].map(deg => deg * Math.PI / 180);
            
            // Draw polygon
            ctx.beginPath();
            angles.forEach((angle, index) => {
                const score = scores[categories[index]];
                const distance = (score / 10) * radius;
                const x = centerX + distance * Math.cos(angle);
                const y = centerY + distance * Math.sin(angle);
                
                if (index === 0) {
                    ctx.moveTo(x, y);
                } else {
                    ctx.lineTo(x, y);
                }
            });
            ctx.closePath();
            ctx.fillStyle = 'rgba(204, 104, 114, 0.2)';
            ctx.fill();
            ctx.strokeStyle = '#cc6872';
            ctx.stroke();
        }

        // Characters Functions
        function displayCharacters() {
            const charactersList = document.getElementById('charactersList');
            charactersList.innerHTML = '';
            
            // Find recommended character
            const maxCategory = Object.keys(scores).reduce((a, b) => scores[a] > scores[b] ? a : b);
            const recommendedIndex = characters.findIndex(char => 
                char.specialty.toLowerCase().includes(maxCategory.toLowerCase())
            );
            const recommendedChar = characters[recommendedIndex >= 0 ? recommendedIndex : 0];
            
            // Update recommendation banner
            document.getElementById('recommendationBanner').innerHTML = `
                <strong>üåü RECOMMENDED FOR YOU</strong><br>
                Based on your results, we think you'll love <strong>${recommendedChar.name}</strong>!
            `;
            
            // Create character cards
            characters.forEach(character => {
                const card = document.createElement('div');
                card.className = 'character-card';
                card.innerHTML = `
                    <div class="character-header">
                        <div class="character-avatar" style="background: ${character.color};">
                            ${character.emoji}
                        </div>
                        <div>
                            <h3>${character.name}</h3>
                            <p>${character.description}</p>
                        </div>
                    </div>
                    <p><strong>Specialty:</strong> ${character.specialty}</p>
                    <div class="character-drawing">${character.drawing}</div>
                    <button class="btn" onclick="selectCharacter('${character.name}')" 
                            style="background: ${character.color};">
                        Choose This Friend ü¶ã
                    </button>
                `;
                charactersList.appendChild(card);
            });
        }

        function selectCharacter(characterName) {
            selectedCharacter = characters.find(char => char.name === characterName);
            showScreen('chatScreen');
            setupChat();
        }

        // Chat Functions
        function setupChat() {
            document.getElementById('chatHeader').textContent = 
                `üí¨ Chat with ${selectedCharacter.name} ${selectedCharacter.emoji}`;
            document.getElementById('chatCharacterName').textContent = selectedCharacter.name;
            document.getElementById('chatCharacterDesc').textContent = selectedCharacter.description;
            document.getElementById('chatCharacterDrawing').textContent = selectedCharacter.drawing;
            document.getElementById('chatAvatar').style.background = selectedCharacter.color;
            document.getElementById('chatAvatar').textContent = selectedCharacter.emoji;
            
            // Clear messages and add welcome
            const messages = document.getElementById('messages');
            messages.innerHTML = '';
            addMessage(`${selectedCharacter.name}: Hi there! I'm excited to chat with you! What would you like to talk about? ${selectedCharacter.emoji} ${selectedCharacter.drawing}`, 'bot');
        }

        function addMessage(text, sender) {
            const messages = document.getElementById('messages');
            const messageDiv = document.createElement('div');
            messageDiv.className = `message ${sender}-message`;
            messageDiv.textContent = text;
            messages.appendChild(messageDiv);
            messages.scrollTop = messages.scrollHeight;
        }

        function sendMessage() {
            const input = document.getElementById('chatInput');
            const message = input.value.trim();
            
            if (message) {
                addMessage(`You: ${message}`, 'user');
                input.value = '';
                
                // Simulate AI response
                setTimeout(() => {
                    const responses = [
                        `That's really interesting! Tell me more about that. ${selectedCharacter.emoji}`,
                        `I love how you think! What else is on your mind? ${selectedCharacter.drawing}`,
                        `That's a great perspective! How does that make you feel? ${selectedCharacter.emoji}`,
                        `Wonderful! I'd love to explore this more with you. ${selectedCharacter.drawing}`,
                        `That's fascinating! Could you tell me more? ${selectedCharacter.emoji}`,
                        `I appreciate you sharing that with me! ${selectedCharacter.drawing}`
                    ];
                    const randomResponse = responses[Math.floor(Math.random() * responses.length)];
                    addMessage(`${selectedCharacter.name}: ${randomResponse}`, 'bot');
                }, 1000);
            }
        }

        // Enter key support for chat
        document.getElementById('chatInput')?.addEventListener('keypress', function(e) {
            if (e.key === 'Enter') {
                sendMessage();
            }
        });

        // Initialize scale slider
        document.getElementById('scaleSlider')?.addEventListener('input', updateScaleValue);
    </script>
</body>
</html>